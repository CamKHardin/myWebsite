<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Knowledge Base - Cameron Hardin</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <style>
        #searchBar {
            width: 100%;
            padding: 10px;
            margin-bottom: 20px;
            font-size: 16px;
        }
        #knowledge-content {
            max-height: 500px;
            overflow-y: auto;
            border: 1px solid #ddd;
            padding: 20px;
            background-color: #f9f9f9;
        }
        .hidden {
            display: none;
        }
        .error-message {
            color: red;
        }
    </style>
</head>

<body>
    <header>
        <h1>Cameron Hardin's Knowledge Base</h1>
    </header>

    <nav>
        <a href="index.html">Home</a>
        <a href="about.html">About Me</a>
        <a href="projects.html">Projects</a>
        <a href="contact.html">Contact</a>
        <a href="knowledge.html">Knowledge Base</a>
    </nav>

    <div class="container">
        <!-- Search bar -->
        <input type="text" id="searchBar" placeholder="Search the Knowledge Base...">
        <section id="knowledge">
            <h2>Knowledge Base</h2>
            <div id="knowledge-content">Loading knowledge base...</div> <!-- Block to hold the knowledge base content -->
        </section>
    </div>

    <footer>
        <p>&copy; 2024 Cameron Hardin. All rights reserved.</p>
    </footer>

    <script>
        async function fetchMarkdownFile() {
            try {
                // Fetch the knowledge_base.md file from your GitHub Pages repository
                const response = await fetch('https://raw.githubusercontent.com/CamKHardin/CamKHardin.github.io/main/knowledge_base.md');
                
                if (!response.ok) {
                    throw new Error('Markdown file not found or failed to fetch.');
                }

                const fileContent = await response.text();
                displayContent(fileContent);
            } catch (error) {
                displayError(`Error fetching the Markdown file: ${error.message}`);
            }
        }

        function displayContent(content) {
            const knowledgeContent = document.getElementById('knowledge-content');
            const parsedContent = parseMarkdown(content);
            knowledgeContent.innerHTML = parsedContent;

            enableSearch(); // Call search functionality after rendering
        }

        function parseMarkdown(content) {
            // Simple markdown to HTML converter
            let htmlContent = content
                .replace(/^# (.*$)/gim, '<h1>$1</h1>')         // H1
                .replace(/^## (.*$)/gim, '<h2>$1</h2>')        // H2
                .replace(/^### (.*$)/gim, '<h3>$1</h3>')       // H3
                .replace(/^\*\*(.*)\*\*/gim, '<strong>$1</strong>') // Bold
                .replace(/^- (.*$)/gim, '<li>$1</li>')         // List items
                .replace(/\n/gim, '<br />');                   // New line to <br>

            return `<ul>${htmlContent}</ul>`;
        }

        // Search functionality
        function enableSearch() {
            const searchBar = document.getElementById('searchBar');
            searchBar.addEventListener('input', function() {
                const filter = searchBar.value.toLowerCase();
                const content = document.getElementById('knowledge-content');
                const listItems = content.getElementsByTagName('li');

                for (let i = 0; i < listItems.length; i++) {
                    const text = listItems[i].textContent.toLowerCase();
                    if (text.includes(filter)) {
                        listItems[i].classList.remove('hidden');
                    } else {
                        listItems[i].classList.add('hidden');
                    }
                }
            });
        }

        function displayError(message) {
            const knowledgeContent = document.getElementById('knowledge-content');
            knowledgeContent.innerHTML = `<p class="error-message">${message}</p>`;
        }

        // Fetch and display the markdown content on page load
        fetchMarkdownFile();
    </script>
</body>
</html>
